function showCalendarEventResponse(A){var E=A.responseText;var C=A.responseText.indexOf("<body>");if(C>-1){var B=A.responseText.indexOf("</body>");E=A.responseText.substring(C+"<body>".length,B)}var D=AppUtils.getClassOfWindow();var F=new Window(AppUtils.getNewId(),{className:D,width:470,height:180,zIndex:100,resizable:true,title:"Event Item",showEffect:Effect.BlindDown,hideEffect:Effect.SwitchOff,opacity:0.95,draggable:true});F.setDestroyOnClose();F.getContent().innerHTML=E;F.showCenter(false)}function openEventWindowData(C){var A="content/phpicalendar/includes/event.php";var B="date="+C.date+"&time="+C.time+"&uid="+C.uid+"&cpath="+C.cpath+"&event_data="+C.event_data;return ajaxRequest(A,showCalendarEventResponse,ajaxErrorHandler,B)}function EventData(B,E,C,D,A){this.date=B;this.time=E;this.uid=C;this.cpath=D;this.event_data=A;openEventWindowData(this)}function clickICalEvent(object){var scriptNodes=object.parentNode.getElementsByTagName("script");if(scriptNodes.length>0){var nodeValue=scriptNodes.item(0).innerHTML.substring();var start=nodeValue.indexOf("EventData");var stop=nodeValue.lastIndexOf("document");nodeValue=nodeValue.substring(start,stop);eval(nodeValue)}else{var hrefValue=String(object.getAttribute("href"));var pos=hrefValue.lastIndexOf("/");if(pos>-1){hrefValue=hrefValue.substring(pos+1)}getCalendar(hrefValue)}return false}function showCalendarTodoInfoResponse(A){var E=A.responseText;var C=A.responseText.indexOf("<body>");if(C>-1){var B=A.responseText.indexOf("</body>");E=A.responseText.substring(C+"<body>".length,B)}var D=AppUtils.getClassOfWindow();var F=new Window(AppUtils.getNewId(),{className:D,width:460,height:275,zIndex:100,resizable:true,title:"Todo Item",showEffect:Effect.BlindDown,hideEffect:Effect.SwitchOff,opacity:0.95,draggable:true});F.setDestroyOnClose();F.getContent().innerHTML=E;F.showCenter(true)}function openTodoInfo(C){var B="content/phpicalendar/includes/todo.php?vtodo_array="+C;var A="vtodo_array="+C;return ajaxRequest(B,showCalendarTodoInfoResponse,ajaxErrorHandler,A)}document.popup_data=new Array();var idCount=0;function createCalendarNodeID(C){if(C.id.length<1){var B="";var A=String(C.getAttribute("onclick"));C.removeAttribute("onclick");if(A==null||(A.indexOf("null")>-1)){B="openEventWindow_"+(idCount++)}else{var D=A.substring(A.indexOf("(")+1,A.lastIndexOf(")"));A="openEventWindow_"+D;B=A}C.id=B}}var my_iCal_rules={"td.rowOff2":function(A){A.onclick=function(){this.removeAttribute("onclick")}},"td.rowOff":function(A){A.onclick=function(){this.removeAttribute("onclick")}},"td.rowOn2":function(A){A.onclick=function(){this.removeAttribute("onclick")}},"td.rowOn":function(A){A.onclick=function(){this.removeAttribute("onclick")}},"td.rowToday":function(A){A.onclick=function(){this.removeAttribute("onclick")}},"select.query_style":function(A){A.onchange=function(){getCalendar(this.options[this.selectedIndex].value)}},"a.ps":function(A){createCalendarNodeID(A);A.onclick=function(){clickICalEvent(this);this.removeAttribute("href")}},"a.ps3":function(A){createCalendarNodeID(A);A.onclick=function(){clickICalEvent(this);this.removeAttribute("href")}},"a.psf":function(element){element.onclick=function(){var hrefValue=String(element.getAttribute("href"));this.removeAttribute("href");if(hrefValue.indexOf("javascript:")>-1){eval(hrefValue)}else{var pos=hrefValue.lastIndexOf("/");if(pos>-1){hrefValue=hrefValue.substring(pos+1);getCalendar(hrefValue)}else{if(hrefValue.lastIndexOf("#")>-1){clickICalEvent(this)}else{getCalendar(hrefValue)}}}return false}}};Behaviour.register(my_iCal_rules);